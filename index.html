<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electric Boogaloo - AI Bomberman</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- API Key Modal -->
    <div id="apiModal" class="modal">
        <div class="modal-content">
            <h2>⚡ OPENAI API ACCESS ⚡</h2>
            <p>Enter your OpenAI API key to power the AI players</p>
            <input type="password" id="apiKeyInput" placeholder="sk-..." />
            <button id="saveApiKey">INITIALIZE</button>
            <p class="model-info">Model: gpt-4.1-mini</p>
        </div>
    </div>

    <!-- System Prompt Modal -->
    <div id="systemPromptModal" class="modal hidden">
        <div class="modal-content system-prompt-modal">
            <h2>⚙️ SYSTEM PROMPT EDITOR ⚙️</h2>
            <p>Edit the core game rules and instructions sent to all AI players</p>
            <textarea id="systemPromptEditor" rows="20"></textarea>
            <div class="modal-buttons">
                <button id="saveSystemPrompt">SAVE</button>
                <button id="resetSystemPrompt">RESET TO DEFAULT</button>
                <button id="closeSystemPrompt">CLOSE</button>
            </div>
        </div>
    </div>

    <!-- Prompt Window (Draggable Floating Window) -->
    <div id="promptWindow" class="prompt-window hidden">
        <div class="prompt-window-header">
            <span id="promptWindowTitle">Player Prompt</span>
            <button id="closePromptWindow" class="window-close-btn">✕</button>
        </div>
        <div class="prompt-window-body">
            <div class="prompt-window-text">
                <label>Complete Prompt (as sent to OpenAI):</label>
                <div id="promptWindowCurrentText"></div>
            </div>
        </div>
    </div>

    <!-- Game Container -->
    <div id="gameContainer">
        <!-- Top Left Prompt -->
        <div class="prompt-editor top-left">
            <div class="prompt-header">
                PLAYER 1 [CYAN]
                <button class="reset-prompt" data-player="1" title="Reset to default">↻</button>
            </div>
            <textarea id="prompt1" placeholder="Enter AI strategy...">You are Player 1 (cyan). EXPLORE toward center (G6). Drop bombs near soft blocks. Check DANGER ANALYSIS and follow your previous plan - don't repeat moves!</textarea>
        </div>

        <!-- Top Right Prompt -->
        <div class="prompt-editor top-right">
            <div class="prompt-header">
                PLAYER 2 [MAGENTA]
                <button class="reset-prompt" data-player="2" title="Reset to default">↻</button>
            </div>
            <textarea id="prompt2" placeholder="Enter AI strategy...">You are Player 2 (magenta). AGGRESSIVE play - move toward center G6, destroy blocks, hunt opponents. Review SAFE MOVES and adapt your strategy each turn!</textarea>
        </div>

        <!-- Game Board -->
        <div id="gameBoard">
            <div id="gameInfo">
                <div class="info-left">
                    <span id="turnCounter">TURN: 0</span>
                    <span id="currentPlayer">CURRENT: P1</span>
                </div>
                <div class="info-center">
                    <h1>╔═══ ELECTRIC BOOGALOO ═══╗</h1>
                </div>
                <div class="info-right">
                    <button id="startGame">START</button>
                    <button id="pauseGame">PAUSE</button>
                    <button id="resetGame">RESET</button>
                    <button id="editSystemPrompt">SYSTEM PROMPT</button>
                    <a href="demo.html" style="text-decoration: none;"><button style="background: rgba(255, 0, 255, 0.2); border: 1px solid #ff00ff;">DEMO VIDEO</button></a>
                </div>
            </div>
            <div id="gridContainer">
                <div id="rowLabels"></div>
                <div id="grid"></div>
                <div id="colLabels"></div>
            </div>
            <div id="scoreBoard">
                <div class="score">P1: <span id="score1">0</span></div>
                <div class="score">P2: <span id="score2">0</span></div>
                <div class="score">P3: <span id="score3">0</span></div>
                <div class="score">P4: <span id="score4">0</span></div>
            </div>
        </div>

        <!-- Bottom Left Prompt -->
        <div class="prompt-editor bottom-left">
            <div class="prompt-header">
                PLAYER 3 [YELLOW]
                <button class="reset-prompt" data-player="3" title="Reset to default">↻</button>
            </div>
            <textarea id="prompt3" placeholder="Enter AI strategy...">You are Player 3 (yellow). DEFENSIVE explorer - clear blocks for escape routes, maintain distance from opponents. Use DANGER ANALYSIS to stay safe and adapt plans!</textarea>
        </div>

        <!-- Bottom Right Prompt -->
        <div class="prompt-editor bottom-right">
            <div class="prompt-header">
                PLAYER 4 [GREEN]
                <button class="reset-prompt" data-player="4" title="Reset to default">↻</button>
            </div>
            <textarea id="prompt4" placeholder="Enter AI strategy...">You are Player 4 (green). BALANCED tactician - mix offense/defense, explore center area, trap opponents strategically. Follow SAFE MOVES and evolve your plan!</textarea>
        </div>

        <!-- NPC Character Palette (Battle Royale Airdrop) -->
        <div id="npcPalette" class="prompt-editor npc-palette">
            <div class="prompt-header npc-palette-header">⚡ BATTLE ROYALE NPCs ⚡</div>
            <div class="npc-grid">
                <!-- NPCs populated by JavaScript -->
            </div>
            <div class="npc-instructions">Drag & drop onto board to spawn</div>
        </div>
    </div>

    <!-- Error Popup Modal -->
    <div id="errorModal" class="modal" style="display:none;">
        <div class="modal-content">
            <h2>⚠️ AI PARSING ERROR</h2>
            <div id="errorDetails" class="error-details"></div>
            <div class="modal-buttons">
                <button id="closeError">CLOSE</button>
            </div>
        </div>
    </div>

    <!-- Game Log (optional debug info) -->
    <div id="gameLog">
        <div class="log-header">SYSTEM LOG</div>
        <div id="logContent"></div>
    </div>

    <!-- Scripts -->
    <!-- NEW ARCHITECTURE (ready for upcoming features) -->
    <script src="js/actions.js"></script>
    <script src="js/state.js"></script>
    <script src="js/entities/player.js"></script>
    <script src="js/entities/bomb.js"></script>
    <script src="js/entities/item.js"></script>
    <script src="js/entities/explosion.js"></script>
    <script src="js/history.js"></script>
    <script src="js/serialization.js"></script>

    <!-- LEGACY CODE (currently active) -->
    <script src="js/npc-characters.js"></script>
    <script src="js/player.js"></script>
    <script src="js/game.js"></script>
    <script src="js/ai.js"></script>
    <script src="js/drag-drop.js"></script>
    <script src="js/ui.js"></script>
</body>
</html>
